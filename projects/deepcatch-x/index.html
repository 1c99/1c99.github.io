<!DOCTYPE html>
<html>
  <head>
    <link rel="shortcut icon" href="../../images/logo.png" />
    <title>DeepCatch X - Wonchan Son</title>
    <link rel="stylesheet" href="../../css/fa6-all.min.css" />
    <link rel="stylesheet" href="../../css/fa6-local-fonts.css" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="description" content="DeepCatch X: AI-Powered X-ray Analysis Platform for Aortic Disease Detection" />
    <script src="../../js/jquery.min.js"></script>
    <script src="../../js/skel.min.js"></script>
    <script src="../../js/skel-layers.min.js"></script>
    <script src="../../js/init.js"></script>
    <noscript>
      <link rel="stylesheet" href="../../css/skel.css" />
      <link rel="stylesheet" href="../../css/style.css" />
      <link rel="stylesheet" href="../../css/style-xlarge.css" />
    </noscript>
    <link rel="stylesheet" href="../../css/project.css" />
  </head>

  <body class="project-page">
    <div id="wrapper">
      <div id="main">
        <!-- Back Navigation -->
        <section class="project-nav">
          <div class="container">
            <a href="../../index.html#experience">
              <i class="fa-solid fa-arrow-left"></i> Back to Main
            </a>
          </div>
        </section>

        <!-- Project Header -->
        <section id="project-header">
          <div class="container">
            <header class="major">
              <h2>DeepCatch X</h2>
              <p>AI-Powered X-ray Analysis Platform</p>
            </header>
            <p class="project-meta">
              <i class="fa-solid fa-building"></i> Medical IP &nbsp;|&nbsp;
              <i class="fa-solid fa-calendar"></i> Nov. 2023 &ndash; Present &nbsp;|&nbsp;
              <i class="fa-solid fa-location-dot"></i> Seoul, South Korea
            </p>
          </div>
        </section>

        <!-- Table of Contents -->
        <nav class="toc">
          <h4>Contents</h4>
          <ul>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#gtc">NVIDIA GTC 2025 Showcase</a></li>
            <li><a href="#diffusion">Stage 1: DDPM for 2D Aorta Extraction</a></li>
            <li><a href="#ldm-3d">Stage 2: LDM for 3D Volumetric Reconstruction</a></li>
            <li><a href="#ray-pipeline">Ray Distributed Inference Pipeline</a></li>
            <li><a href="#nuitka">Refactoring &amp; Nuitka Deployment</a></li>
            <li><a href="#bioage">BioAge Prediction Module (R to C++)</a></li>
            <li><a href="#dataset">Dataset Acquisition</a></li>
          </ul>
        </nav>

        <!-- Overview -->
        <section id="overview">
          <div class="container">
            <h3>Overview</h3>
            <p>
              DeepCatch X is an AI-powered medical imaging platform that reconstructs 3D aortic structures
              from single 2D chest X-rays, enabling non-invasive screening for thoracic aortic diseases.
              The core contribution is a <strong>two-stage generative pipeline</strong>: Stage 1 uses DDPM for
              conditional 2D aorta extraction, and Stage 2 uses a <strong>novel Latent Diffusion Model (LDM)
              with custom 3D architectures</strong> for volumetric reconstruction from the 2D projection.
            </p>
            <p>
              The project spans research (novel architectures, ablation studies) to production deployment
              (distributed inference, standalone executables, regulatory compliance).
            </p>
            <div class="tech-stack">
              <span class="tech-tag">PyTorch</span>
              <span class="tech-tag">DDPM</span>
              <span class="tech-tag">LDM</span>
              <span class="tech-tag">Ray</span>
              <span class="tech-tag">TensorRT</span>
              <span class="tech-tag">C++</span>
              <span class="tech-tag">DDP</span>
            </div>

            <!-- Two-Stage Pipeline Diagram -->
            <div class="architecture-diagram">
              <div class="diagram-title">Two-Stage Generative Pipeline</div>
              <div class="flow-diagram">
                <div class="flow-box">
                  <div class="box-title">X-ray Input</div>
                  <div class="box-subtitle">2D Image</div>
                </div>
                <span class="flow-arrow">&rarr;</span>
                <div class="flow-box highlight">
                  <div class="box-title">Stage 1: DDPM</div>
                  <div class="box-subtitle">2D Aorta Extraction</div>
                </div>
                <span class="flow-arrow">&rarr;</span>
                <div class="flow-box">
                  <div class="box-title">2D Aorta Mask</div>
                  <div class="box-subtitle">Projection</div>
                </div>
                <span class="flow-arrow">&rarr;</span>
                <div class="flow-box highlight">
                  <div class="box-title">Stage 2: LDM</div>
                  <div class="box-subtitle">3D Reconstruction</div>
                </div>
                <span class="flow-arrow">&rarr;</span>
                <div class="flow-box">
                  <div class="box-title">3D Aorta Volume</div>
                  <div class="box-subtitle">128&sup3; Output</div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Section 1: NVIDIA GTC -->
        <section id="gtc" class="card">
          <div class="container">
            <h3>NVIDIA GTC 2025 Showcase</h3>

            <h4>Background</h4>
            <p>
              Showcased DeepCatch X at NVIDIA GTC 2025 in San Jose, demonstrating novel generative AI
              applications in medical imaging to a global audience of researchers, engineers, and
              healthcare professionals.
            </p>

            <h4>Key Demonstrations</h4>
            <ul>
              <li>Real-time X-ray to 3D aorta extraction pipeline</li>
              <li>AI-powered quantitative measurements for aortic aneurysm detection</li>
              <li>Integration with clinical workflows</li>
            </ul>
          </div>
        </section>

        <!-- Section 2: Stage 1 - DDPM -->
        <section id="diffusion" class="card">
          <div class="container">
            <h3>Stage 1: DDPM for 2D Aorta Extraction</h3>

            <h4>Problem</h4>
            <p>
              Traditional GAN-based approaches for X-ray to aorta extraction suffered from mode collapse,
              training instability, and artifacts that could lead to clinical misinterpretation.
            </p>

            <h4>Approach</h4>
            <p>
              Implemented a DDPM (Denoising Diffusion Probabilistic Model) for conditional image-to-image
              translation. The model learns the reverse diffusion process to generate 2D aortic projection
              masks conditioned on X-ray input via channel concatenation.
            </p>

            <h4>Technical Details</h4>
            <ul>
              <li>Conditional channel concatenation (X-ray RGBA + noise)</li>
              <li>U-Net backbone with self-attention, time embedding, and ResNet blocks</li>
              <li>DDP training across 4x RTX 4090 GPUs with gradient accumulation</li>
              <li>Hybrid loss: weighted MSE + perceptual (VGG) + SSIM + L1</li>
              <li>DDIM fast sampling for inference (50 steps)</li>
            </ul>

            <h4>Ablation Studies</h4>
            <ul>
              <li>Conditioning mechanism: concatenation vs. cross-attention vs. AdaIN</li>
              <li>Attention placement: bottleneck-only vs. multi-scale</li>
              <li>Noise schedule: linear vs. cosine vs. sigmoid</li>
              <li>Network depth optimization</li>
            </ul>
          </div>
        </section>

        <!-- Section 3: Stage 2 - 3D LDM -->
        <section id="ldm-3d" class="card">
          <div class="container">
            <h3>Stage 2: LDM for 3D Volumetric Reconstruction</h3>

            <h4>Problem</h4>
            <p>
              Reconstructing 3D volumetric structures from a single 2D projection is a severely ill-posed
              inverse problem. Direct 3D diffusion is computationally prohibitive (128&sup3; volumes require
              ~48GB memory for training).
            </p>

            <h4>Approach</h4>
            <p>
              Proposed a <strong>Latent Diffusion Model (LDM)</strong> that operates in compressed latent space,
              with <strong>custom 3D architectures</strong> designed specifically for medical volumetric reconstruction.
            </p>

            <h4>Novel Architectures Proposed</h4>
            <ul>
              <li><strong>VAE3D:</strong> 3D Variational Autoencoder compressing 128&sup3; volumes to 256-dim latent space (16x compression per dimension)</li>
              <li><strong>Projection2Dto3D:</strong> Novel network bridging 2D aorta features to 3D latent representation via hierarchical Conv2D &rarr; Linear &rarr; Conv3D projection</li>
              <li><strong>UNet3DConditioned:</strong> 3D U-Net denoiser with InstanceNorm, LeakyReLU, and time conditioning</li>
              <li><strong>SpatialTransformer3D:</strong> Self-attention over 3D volumetric spatial dimensions</li>
              <li><strong>LatentDiffusion3D:</strong> Complete LDM integrating all components for end-to-end 2D&rarr;3D generation</li>
            </ul>

            <h4>Ablation Studies (Stage 2)</h4>
            <ul>
              <li>VAE latent dimension: 64 / 128 / 256 / 512</li>
              <li>3D UNet depth optimization</li>
              <li>3D attention placement strategies</li>
              <li>2D&rarr;3D projection architecture comparison</li>
            </ul>

            <h4>Key Innovation</h4>
            <p>
              The <strong>Projection2Dto3D</strong> architecture addresses the core challenge of lifting 2D information
              to 3D space, using a hierarchical approach that preserves spatial relationships while expanding dimensionality.
            </p>
          </div>
        </section>

        <!-- Section 4: Ray Pipeline -->
        <section id="ray-pipeline" class="card">
          <div class="container">
            <h3>Ray Distributed Inference Pipeline</h3>

            <h4>Problem</h4>
            <p>
              Sequential model execution created bottlenecks; each analysis step had to complete
              before the next could begin. Hospital deployments have heterogeneous hardware
              (varying GPU counts, memory sizes), requiring adaptive resource allocation.
            </p>

            <h4>Approach</h4>
            <p>
              Built a DAG-based distributed inference system using Ray framework. Models execute
              as independent actors with automatic task scheduling and zero-copy data sharing
              via Apache Arrow-based Object Store.
            </p>

            <!-- Module Dependency DAG Diagram -->
            <div class="architecture-diagram">
              <div class="diagram-title">Module Dependency Graph &amp; DAG Scheduling</div>

              <!-- Input -->
              <div class="dag-level">
                <div class="dag-node input">Input DICOM</div>
              </div>
              <div class="dag-arrow">&darr;</div>

              <!-- Level 0 -->
              <div class="dag-level-label">Level 0: Independent (parallel)</div>
              <div class="dag-level">
                <div class="dag-node">Lung<span>2048&times;2048</span></div>
                <div class="dag-node">Heart<span>512&times;512</span></div>
                <div class="dag-node">Bone<span>512&times;512</span></div>
                <div class="dag-node">Aorta<span>512&times;512</span></div>
              </div>
              <div class="dag-arrow">&darr;</div>

              <!-- Level 1 -->
              <div class="dag-level-label">Level 1: Depend on Level 0</div>
              <div class="dag-level">
                <div class="dag-node">COVID<span>&larr; lung</span></div>
                <div class="dag-node">Vessel<span>&larr; lung</span></div>
                <div class="dag-node">TB<span>&larr; lung</span></div>
                <div class="dag-node">Diameter<span>&larr; aorta</span></div>
              </div>
              <div class="dag-arrow">&darr;</div>

              <!-- Level 2 -->
              <div class="dag-level-label">Level 2: Depend on Level 0/1</div>
              <div class="dag-level">
                <div class="dag-node">CTR<span>&larr; lung + heart</span></div>
                <div class="dag-node">Peripheral<span>&larr; lung</span></div>
                <div class="dag-node">Volumetry<span>&larr; lung + heart</span></div>
              </div>
            </div>

            <h4>Technical Implementation</h4>
            <ul>
              <li>Ray actors for stateful model serving with GPU memory persistence</li>
              <li>DAG scheduler with dependency resolution and parallel execution</li>
              <li>Zero-copy data sharing between actors via Ray Object Store</li>
              <li>Resource monitoring with automatic GPU/CPU allocation</li>
              <li>Graceful degradation for hardware failures</li>
            </ul>

            <div class="metrics">
              <h4>Results</h4>
              <div class="metric-item">
                <span class="metric-value">6x</span>
                <span class="metric-label">Batch Throughput</span>
              </div>
              <div class="metric-item">
                <span class="metric-value">2.8x</span>
                <span class="metric-label">Per-Case Speedup</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Section 4: Nuitka -->
        <section id="nuitka" class="card">
          <div class="container">
            <h3>Refactoring &amp; Nuitka Deployment</h3>

            <h4>Problem</h4>
            <p>
              Hospital deployment required distributing deep learning inference code as standalone
              executables without Python environment setup. IP protection was also critical
              for commercial deployment.
            </p>

            <h4>Approach</h4>
            <p>
              Major codebase refactoring to remove unnecessary abstractions, followed by Nuitka
              compilation to produce standalone executables with bundled CUDA/PyTorch dependencies.
              Applied model optimizations (TensorRT, ONNX, FP16) for inference acceleration.
            </p>

            <h4>Technical Details</h4>
            <ul>
              <li>Codebase refactoring: removed dead code, unified configurations, simplified architecture</li>
              <li>Model optimization: TensorRT compilation, ONNX export, FP16 precision</li>
              <li>Nuitka compilation with PyTorch/CUDA bundling for standalone deployment</li>
              <li>CdsPyEncrypt integration for source code protection</li>
            </ul>

            <!-- Before/After Comparison Diagram -->
            <div class="architecture-diagram">
              <div class="diagram-title">Codebase Refactoring Results</div>
              <div class="comparison-diagram">
                <div class="comparison-side before">
                  <div class="comparison-label">Before</div>
                  <div class="comparison-stat">
                    <span class="stat-label">Total Files</span>
                    <span class="stat-value">110</span>
                  </div>
                  <div class="comparison-stat">
                    <span class="stat-label">Lines of Code</span>
                    <span class="stat-value">34,266</span>
                  </div>
                  <div class="comparison-stat">
                    <span class="stat-label">Duplicate Code</span>
                    <span class="stat-value">47%</span>
                  </div>
                  <div class="comparison-stat">
                    <span class="stat-label">Entry Points</span>
                    <span class="stat-value">6</span>
                  </div>
                </div>
                <div class="comparison-side after">
                  <div class="comparison-label">After</div>
                  <div class="comparison-stat">
                    <span class="stat-label">Total Files</span>
                    <span class="stat-value">15</span>
                  </div>
                  <div class="comparison-stat">
                    <span class="stat-label">Lines of Code</span>
                    <span class="stat-value">8,017</span>
                  </div>
                  <div class="comparison-stat">
                    <span class="stat-label">Duplicate Code</span>
                    <span class="stat-value">0%</span>
                  </div>
                  <div class="comparison-stat">
                    <span class="stat-label">Entry Points</span>
                    <span class="stat-value">1</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="metrics">
              <h4>Results</h4>
              <div class="metric-item">
                <span class="metric-value">73%</span>
                <span class="metric-label">Codebase Reduction</span>
              </div>
              <div class="metric-item">
                <span class="metric-value">Standalone</span>
                <span class="metric-label">Executable Deployment</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Section 5: BioAge -->
        <section id="bioage" class="card">
          <div class="container">
            <h3>BioAge Prediction Module (R to C++)</h3>

            <h4>Problem</h4>
            <p>
              The biological age estimation algorithm was implemented in R for research. Production
              deployment required: no R runtime dependency, sub-millisecond latency, thread safety,
              and GPU pipeline integration with LibTorch.
            </p>

            <h4>Approach</h4>
            <p>
              Complete algorithm port from R to C++ using normative modeling approach.
              The algorithm uses Mahalanobis distance to measure deviation from healthy reference
              population, converting organ-level health distances to biological age estimates.
            </p>

            <h4>Technical Details</h4>
            <ul>
              <li>1,850+ lines of production C++ code with numerical equivalence to R</li>
              <li>Normative modeling: Mahalanobis distance for deviation measurement</li>
              <li>Zero external file dependencies via embedded statistical parameters</li>
              <li>Banker's rounding (IEC 60559) for numerical fidelity with R</li>
              <li>52 clinical output fields including risk scores and recommendations</li>
            </ul>

            <div class="metrics">
              <h4>Results</h4>
              <div class="metric-item">
                <span class="metric-value">150x</span>
                <span class="metric-label">Faster than R</span>
              </div>
              <div class="metric-item">
                <span class="metric-value">0</span>
                <span class="metric-label">File Dependencies</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Section 6: Dataset -->
        <section id="dataset" class="card">
          <div class="container">
            <h3>Dataset Acquisition</h3>

            <h4>Challenge</h4>
            <p>
              FDA and MFDS regulatory submissions require extensive clinical validation on
              diverse, representative datasets. Acquiring and managing medical imaging data
              at scale presents unique logistical and compliance challenges.
            </p>

            <h4>Contributions</h4>
            <ul>
              <li>Directed end-to-end acquisition of massive-scale medical datasets (100TB+)</li>
              <li>Coordinated with multiple hospital partners for data collection</li>
              <li>Established data governance and de-identification pipelines</li>
              <li>Managed storage infrastructure and data versioning</li>
              <li>Prepared documentation for regulatory submissions</li>
            </ul>
          </div>
        </section>

        <!-- Footer -->
        <footer class="project-footer">
          <p>&copy; Wonchan Son | <a href="../../index.html">Back to Home</a></p>
        </footer>
      </div>
    </div>
  </body>
</html>
